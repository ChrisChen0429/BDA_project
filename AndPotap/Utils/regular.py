# ===========================================================================
# Notes
# ===========================================================================
"""
(*) This file contains the functions to clean the employers
    name
"""
# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Import
# ===========================================================================
import pandas as pd
import re
# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Construct functions
# ===========================================================================


def count_len(string):
    a = str(string)
    b = a.split()
    return len(b)


def find_pattern(string, pattern='.'):
    a = str(string)
    b = a.find(pattern)
    c = 1 if b > -1 else 0
    return c


def clean_vendor(vendor):
    aux1 = vendor.apply(count_len)
    aux2 = vendor.apply(find_pattern)
    mask1 = (aux1 == 3) | (aux1 == 4)
    mask2 = (aux2 == 1)

    vendor_col = pd.DataFrame(index=vendor.index)
    vendor_col['vendor_Y'] = 1
    vendor_col.loc[mask1, 'vendor_Y'] = 0
    vendor_col.loc[mask2, 'vendor_Y'] = 1
    return vendor_col

# ===========================================================================
